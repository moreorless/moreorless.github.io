---
layout: post
title: 日志管理与分析
description: 
category: opinion
---


<<Logging and Log Management>>

## 关联分析
### 微观关联

关系的是单一事件或者一组事件中关联的字段

1. 字段关联
2. 规则关联

### 宏观关联

获取其他信息来源，以便进一步验证或者得到事件流上的情报。

1. 规则关联
2. 漏洞关联
3. 指纹关联	Nmap
4. 反端口关联
5. 观察列表关联
6. 地理位置关联

### 关联分析引擎
Rete算法

JESS

Esper


## 统计分析

### 频率

### 基线

基线的实例

* 前一周对端口443的访问次数
* 用户每天使用su命令的时间
* 防火墙新端口的访问计数
* 每天与环境中服务器联系的主机数量

基线的计算方法：
1. 获取数据集的均值
2. 计算标准偏差
3. 计算标准误差
4. 确定置信区间

一些可以用来做基线检测的关键事件

* 用户登录或注销数量(成功或失败)
* 入站和出站网络流量(字节数)
* 特定端口/服务/协议的网络流量
* 管理账户使用/访问
* 运行在服务器上的进程
* 硬件健康统计，如错误率
* DSN请求
* DHCP请求
* 发送和接收的日志数据总数，可用于检测日志数据源出现异常情况或遭受攻击的情况
* 新的攻击类型
* 新的用户名
* 按照协议和端口统计的日志消息类型
* 每个来源独特端口计数

### 机器学习

kNN算法

一些用作kNN检测的特征
1. 过多的出站流量:EOT
2. 过多的入站流量：EIT
3. 下班时间VPN登录
4. 防火墙接受
5. 防火墙拒绝
6. 从内部网络之外登录
7. 连续多次失败登录
8. 至少1次登录成功
9. 单一来源探查多个目标IP
10. 单一来源探查多个目标IP和端口

## 通用事件表达式(Common Event Expression, CEE)

[http://cee.mitre.org/](http://cee.mitre.org/)




